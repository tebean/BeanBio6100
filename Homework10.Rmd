---
title: "Homework10"
output: html_document
date: "2025-04-08"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown
```{r}
# Load libraries
library(tidyverse)
library(ggthemes)
library(ggridges)
library(ggrepel)
library(treemapify)
```

```{r}
# Load the Cheese Characteristics dataset
cheese <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-06-04/cheeses.csv')

# Peek at the data
glimpse(cheese)
```
1. Treemap: number of cheese types by country
```{r}
# Load necessary libraries
library(tidyverse)
library(treemapify)

# Load the Cheese Characteristics dataset
cheese <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-06-04/cheeses.csv')

# Summarize the number of cheese types per country
cheese_country_count <- cheese %>%
  count(country, sort = TRUE) %>%
  filter(!is.na(country))

# Create the treemap plot
treemap_plot <- ggplot(cheese_country_count, aes(area = n, fill = country, label = country)) +
  geom_treemap() +
  geom_treemap_text(color = "white", place = "centre", grow = TRUE) +
  theme_void(base_size = 14) +  # Set a base font size for better readability
  ggtitle("Cheese Types by Country") +
  theme(plot.title = element_text(size = 16, face = "bold"),
        legend.position = "none")  # Hide the legend to prevent overcrowding

# Display the plot
print(treemap_plot)

# Save the plot to a file with specified dimensions
ggsave("cheese_treemap.pdf", treemap_plot, width = 10, height = 8, dpi = 300)
```
2. Ridgeline plot: fat content by texture
```{r}
library(tidyverse)
library(ggridges)

# Clean fat_content column into numeric (average if it's a range)
cheese_clean <- cheese %>%
  filter(!is.na(fat_content), !is.na(texture)) %>%
  mutate(
    fat_clean = str_extract_all(fat_content, "\\d+") %>%
      map_dbl(~ mean(as.numeric(.)))
  )

# Now make the ridgeline plot
ridgeline_plot <- cheese_clean %>%
  ggplot(aes(x = fat_clean, y = texture, fill = texture)) +
  geom_density_ridges(scale = 1.2, alpha = 0.7, color = "black") +
  theme_minimal(base_size = 14) +
  labs(
    title = "Distribution of Fat Content by Texture",
    x = "Fat Content (%)",
    y = "Texture"
  ) +
  theme(legend.position = "none")

ridgeline_plot
```
3. Scatter plot: fat vs moisture by milk type with annotations
```{r}
# Scatter plot with annotations
library(tidyverse)
library(ggridges)
cheese_clean <- cheese %>%
  filter(!is.na(fat_content) & !is.na(milk)) %>%
  mutate(
    fat_content_numeric = str_extract_all(fat_content, "\\d+") %>%
      map_dbl(~ mean(as.numeric(.)))
  )
ggplot(cheese_clean, aes(x = fat_content_numeric, y = milk, fill = milk)) +
  geom_density_ridges(scale = 1.2, alpha = 0.7, color = "black") +
  theme_minimal(base_size = 14) +
  labs(
    title = "Distribution of Fat Content by Milk Type",
    x = "Fat Content (%)",
    y = "Milk Type"
  ) +
  theme(legend.position = "none")
```
4. Mosaic-style bar plot: milk type vs texture
```{r}
# Load necessary libraries
library(tidyverse)
library(ggplot2)

# Load the Cheese Characteristics dataset
cheese <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-06-04/cheeses.csv')

# Data Cleaning and Preparation
cheese_clean <- cheese %>%
  # Filter out rows with missing fat_content or calcium_content
  filter(!is.na(fat_content) & !is.na(calcium_content)) %>%
  # Extract numeric values from fat_content and calcium_content
  mutate(
    fat_content_numeric = str_extract(fat_content, "\\d+") %>% as.numeric(),
    calcium_content_numeric = str_extract(calcium_content, "\\d+") %>% as.numeric()
  ) %>%
  # Remove rows where extraction failed (resulting in NA values)
  filter(!is.na(fat_content_numeric) & !is.na(calcium_content_numeric))

# Create the 2D Density Plot
density_plot <- ggplot(cheese_clean, aes(x = fat_content_numeric, y = calcium_content_numeric)) +
  geom_point(alpha = 0.5, color = "blue") +  # Scatter plot layer
  geom_density2d(aes(color = ..level..), size = 1) +  # 2D density contours
  scale_color_viridis_c() +  # Color scale for density levels
  theme_minimal(base_size = 14) +  # Minimal theme with base font size
  labs(
    title = "2D Density Plot of Fat Content vs. Calcium Content in Cheeses",
    x = "Fat Content (%)",
    y = "Calcium Content (mg)",
    color = "Density Level"
  )

# Display the plot
print(density_plot)

# Save the plot to a file
ggsave("cheese_density_plot.pdf", density_plot, width = 10, height = 8, dpi = 300)
```
```
